<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.uni.mapper.uni_workplaceMapper">
	<select id="workPlaceList"
		resultType="com.uni.domain.uni_workplace_iVO">
		select * from uni_workplace_i
	</select>

	<select id="workPlaceList_i"
		resultType="com.uni.domain.IWorkPlaceVO">
		select * from uni_workplace_i
		where location like
		'%'||#{location}||'%'
	</select>

	<select id="workPlaceList_s"
		resultType="com.uni.domain.SWorkPlaceVO">
		select * from uni_workplace_s
		where location like
		'%'||#{location}||'%'
	</select>

	<select id="avg_star_i" resultType="com.uni.domain.StarAvgVO">
		select round(avg(star)) as
		avg,
		r.ino, i.location from uni_review r join
		uni_workplace_i i on r.ino
		=
		i.ino where i.location like
		'%'||#{location}||'%'
		group by r.ino,
		i.location
	</select>

	<select id="avg_star_s" resultType="com.uni.domain.StarAvgVO">
		select round(avg(star)) as
		avg,
		r.sno, s.location from uni_review r join
		uni_workplace_s s on r.sno
		=
		s.sno where s.location like '%'||#{location}||'%' group by r.sno,
		s.location
	</select>

	<!-- 공유 핫토픽 -->
	<select id="readHotTopic"
		resultType="com.uni.domain.uni_hotTopicVO">

		select round(avg(r.star)) as star, m.name, m.photo,
		w.context,w.thumbnail from
		uni_workplace_s w,uni_review r, uni_member m
		where w.sno = r.sno and
		m.mno = r.mno group by w.sno, w.readcount,
		m.name, m.photo, w.context,
		w.thumbnail order by w.readcount desc

	</select>
	<!-- 임대 핫토픽 -->
	<select id="readHotTopicImde"
		resultType="com.uni.domain.uni_hotTopicVO">

		select round(avg(r.star)) as star, m.name, m.photo,
		w.context, w.thumbnail
		from
		uni_workplace_i w, uni_review r, uni_member
		m where w.ino = r.ino and
		m.mno = r.mno group by w.ino, w.readcount,
		m.name, m.photo,
		w.context,w.thumbnail order by w.readcount desc

	</select>

</mapper>